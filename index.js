const TweetModel = require("./Models/TweetModel");
const UserModel = require("./Models/UserModel");
const TweetRouter = require('./Routes/TweetRoutes');
const UserRouter = require('./Routes/UserRoutes');
const QueryRoutes = require('./Routes/QueryRoutes');
const express = require('express');
const Data = require("./Data");
const QueryModel = require("./Models/QueryModel");
var app = express(); 

const PORT = process.env.PORT || 8080;


Data.SSHDBconnect().then(async ()=>{
    Data.Database.connect((err)=>{
        console.log(err)
    });
    


    app.use('/tweet', TweetRouter);
    app.use('/user', UserRouter);
    app.use('/query', QueryRoutes)
    app.use(express.static(__dirname+'/Public'));
    app.listen(PORT, ()=>{
        console.log("App listening on port" + PORT);
    })
    
    
    // let all = [
    //     '1295942116665950208',
    //     '1295794379169452037',
    //     '1278904908733808641',
    //     '1278893826506178563',
    //     '1277821045425266689',
    //     '1277298407846092800',
    //     '1251213508773130241',
    //     '1250199530030628867',
    //     '1249820324159315968',
    //     '1249740421930024960',
    //     '1249518226201075717',
    //     '1248255449096425472',
    //     '1248099920768368640',
    //     '1246430595254812672',
    //     '1244299186230583296',
    //     '1244265527952003077',
    //     '1241365824625160198',
    //     '1241101721318969345',
    //     '1239419132552122368',
    //     '1238628658622980097',
    //     '1250090722226663424',
    //     '1321138430898651138',
    //     '1321118879607713793',
    //     '1321053661020278792',
    //     '1321049308918173699',
    //     '1321047703179112454',
    //     '1320915621304012801',
    //     '1320850946562220033',
    //     '1320738761970335744',
    //     '1320722567297179649',
    //     '1320718782097141766',
    //     '1320674315545825281',
    //     '1316922847718244354',
    //     '1316831447014084609',
    //     '1316770643136966658',
    //     '1316750327522172928',
    //     '1316579841551077376',
    //     '1316936305218097153',
    //     '1315776076648534018',
    //     '1316771186949476352',
    //     '1316009960954683406',
    //     '1316185723180134409',
    //     '1316913355202985984',
    //     '1319703727708737538',
    //     '1320114040820142082',
    //     '1319475928922279936',
    //     '1320529325926604804',
    //     '1319070706068500481',
    //     '1318565700743569408',
    //     '1319440299928645632',
    //     '1319273108021260291',
    //     '1318578148846542853',
    //     '1318674159187107842',
    //     '1317437978776641537',
    //     '1282073460638978050',
    //     '1293893851350958080',
    //     '1294281713565261825',
    //     '1286332425707151366',
    //     '1297528539915247617',
    //     '1304797707865747459',
    //     '1319273108021260291',
    //     '1321826809827217409',
    //     '1321842908354420736',
    //     '1321821440023449602',
    //     '1239333342744543232',
    //     '1239001526540132353',
    //     '1285864492598009857',
    //     '1273313969491640320',
    //     '1303673417611325441',
    //     '1242475424845893632',
    //     '1238838624851873794',
    //     '1273330307626864642',
    //     '1248046723504541697',
    //     '1317295512727527424',
    //     '1320546686511534080',
    //     '1321303719917572098',
    //     '1319633637348868096',
    //     '1286714858063441920',
    //     '1309185174719139841',
    //     '1251960483265085442',
    //     '1270404343041150976',
    //     '1321976909174104066',
    //     '1322493603248263169',
    //     '1319653672066945024',
    //     '1321607513616371712',
    //     '1320937404325371914',
    //     '1320722914505715712',
    //     '1313330287892402176',
    //     '1310770754061963265',
    //     '1242161624020123649',
    //     '1321160873742901249',
    //     '1316249656439996416',
    //     '1316074440078372867',
    //     '1312216331043831809',
    //     '1316799685353508865',
    //     '1316750327522172928',
    //     '1316831447014084609',
    //     '1316821506530267136',
    // ]
    // all.forEach(async (l)=>{
    //     try{
    //         let data = await TweetModel.getFromAPI(l);
    //         await data.insertToDatabase();
    //         console.log("DOne");
    //     } catch (e){
    //         console.error(e)
    //     }
    // })

    let firstQuery = new QueryModel({
      query: 'Hello World!'  
    });
    await firstQuery.insertToDatabase();
    // console.log("xdxd")

    firstQuery.execute().then(query=>{
        console.log(query.map(l=>l.getData()))
    });

})

